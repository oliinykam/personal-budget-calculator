<div class="container">
    <div class="stats-grid">
    <div class="stat-card income">
        <h3>Total Income</h3>
        <div class="amount">${{ totalIncome.toFixed(2) }}</div>
        <div class="change">+12% from last month</div>
    </div>
    <div class="stat-card expense">
        <h3>Total Expenses</h3>
        <div class="amount">${{ totalExpenses.toFixed(2) }}</div>
        <div class="change">-5% from last month</div>
    </div>
    <div class="stat-card balance">
        <h3>Balance</h3>
        <div class="amount">${{ balance.toFixed(2) }}</div>
        <div class="change">Available this month</div>
    </div>
    </div>

    <div class="chart-section">
    <div class="chart-card">
        <h2>Spending by Category</h2>
        <div class="chart-placeholder">
        <div *ngFor="let item of categoryData" class="category-item">
            <span class="category-label">{{ item.label }}</span>
            <div class="category-bar-container">
            <div class="category-bar" [style.width.%]="(item.value / maxCategoryValue) * 100"></div>
            </div>
            <span class="category-value">${{ item.value.toFixed(2) }}</span>
        </div>
        </div>
    </div>
    
    <div class="chart-card">
        <h2>Recent Activity</h2>
        <div class="activity-list">
        <div class="activity-item">
            <div class="activity-icon income-icon">â†‘</div>
            <div>
            <div class="activity-label">Total Income</div>
            <div class="activity-amount">${{ totalIncome.toFixed(2) }}</div>
            </div>
        </div>
        <div class="activity-item">
            <div class="activity-icon expense-icon">â†“</div>
            <div>
            <div class="activity-label">Total Expenses</div>
            <div class="activity-amount">${{ totalExpenses.toFixed(2) }}</div>
            </div>
        </div>
        <div class="activity-item">
            <div class="activity-icon balance-icon">ðŸ’°</div>
            <div>
            <div class="activity-label">Current Balance</div>
            <div class="activity-amount">${{ balance.toFixed(2) }}</div>
            </div>
        </div>
        </div>
    </div>
    </div>

    <div class="transactions-table">
    <div class="table-header">
        <h2>Recent Transactions</h2>
        <button class="btn btn-primary" (click)="openAddModal()">+ Add Transaction</button>
    </div>
    <table>
        <thead>
        <tr>
            <th>Date</th>
            <th>Description</th>
            <th>Category</th>
            <th>Amount</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let transaction of recentTransactions">
            <td>{{ transaction.date | date: 'MMM d, yyyy' }}</td>
            <td>{{ transaction.description }}</td>
            <td>
            <span class="badge" [ngClass]="getCategoryBadgeClass(transaction.category)">
                {{ transaction.category }}
            </span>
            </td>
            <td [ngClass]="getAmountClass(transaction.amount)">
            {{ formatAmount(transaction.amount) }}
            </td>
        </tr>
        </tbody>
    </table>
    </div>
</div>

<div class="modal-overlay" *ngIf="showAddModal" (click)="closeAddModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Add New Transaction</h2>
      <button class="close-btn" (click)="closeAddModal()">Ã—</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label>Type</label>
        <div class="type-selector">
          <button 
            [class.active]="newTransaction.type === 'income'" 
            (click)="newTransaction.type = 'income'"
            class="type-btn income">Income</button>
          <button 
            [class.active]="newTransaction.type === 'expense'" 
            (click)="newTransaction.type = 'expense'"
            class="type-btn expense">Expense</button>
        </div>
      </div>
      <div class="form-group">
        <label>Description</label>
        <input type="text" [(ngModel)]="newTransaction.description" placeholder="e.g. Salary, Coffee">
      </div>
      <div class="form-group">
        <label>Amount ($)</label>
        <input type="number" [(ngModel)]="newTransaction.amount" placeholder="0.00">
      </div>
      <div class="form-group">
        <label>Category</label>
        <select [(ngModel)]="newTransaction.category">
          <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
        </select>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeAddModal()">Cancel</button>
      <button class="btn btn-primary" (click)="saveTransaction()">Save Transaction</button>
    </div>
  </div>
</div>